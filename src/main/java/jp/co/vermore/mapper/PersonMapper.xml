<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper  namespace="jp.co.vermore.mapper.PersonMapper">
    <resultMap id="PersonResult" type="jp.co.vermore.entity.Person">
        <result column="id" property="id" />
        <result column="user_id" property="userId" />
        <result column="nickname" property="nickname" />
        <result column="first_name" property="firstName" />
        <result column="second_name" property="secondName" />
        <result column="first_name_kana" property="firstNameKana" />
        <result column="second_name_kana" property="secondNameKana" />
        <result column="gender" property="gender" />
        <result column="birthday" property="birthday" />
        <result column="area" property="area" />
        <result column="thumbnail_url" property="thumbnailUrl" />
        <result column="career" property="career" />
        <result column="zipcode" property="zipcode" />
        <result column="address" property="address" />
        <result column="address2" property="address2"/>
        <result column="address3" property="address3"/>
        <result column="mail" property="mail" />
        <result column="create_datetime" property="createDatetime" />
        <result column="update_datetime" property="updateDatetime" />
        <result column="del_flg" property="delFlg" />
        <result column="note" property="note" />
    </resultMap>

    <sql id="Base_Column_List" >
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Wed Feb 28 15:54:28 CST 2018.
        -->
        id,user_id, nickname, first_name, second_name,first_name_kana,second_name_kana, gender,birthday,area,thumbnail_url,career,zipcode,address,address2,address3,mail,
        create_datetime, update_datetime,del_flg, note
    </sql>


    <insert id="insertPerson" parameterType="jp.co.vermore.entity.Person" >
    insert into person(

        <if test="userId != null">
            user_id,
        </if>
        <if test="nickname != null">
            nickname,
        </if>
        <if test="firstName != null">
            first_name,
        </if>
        <if test="secondName != null">
            second_name,
        </if>
        <if test="firstNameKana != null">
            first_name_kana,
        </if>
        <if test="secondNameKana != null">
            second_name_kana,
        </if>
        <if test="gender != null">
            gender,
        </if>
        <if test="birthday != null">
            birthday,
        </if>
        <if test="area != null">
            area,
        </if>
        <if test="thumbnailUrl != null">
            thumbnail_url,
        </if>
        <if test="career != null">
            career,
        </if>
        <if test="zipcode != null">
            zipcode,
        </if>
        <if test="address != null">
            address,
        </if>
        <if test="address2 !=null">
            address2,
        </if>
        <if test="address3 != null">
            address3,
        </if>
        <if test="mail != null">
            mail,
        </if>
        <if test="createDatetime != null">
            create_datetime,
        </if>
        <if test="updateDatetime != null">
            update_datetime,
        </if>
        <if test="delFlg != null">
            del_flg,
        </if>
        <if test="note != null">
            note
        </if>
        ) VALUES (

        <if test="userId != null" >
            #{userId},
        </if>
        <if test="nickname != null" >
            #{nickname,jdbcType=VARCHAR},
        </if>
        <if test="firstName != null" >
            #{firstName,jdbcType=VARCHAR},
        </if>
        <if test="secondName != null" >
            #{secondName,jdbcType=VARCHAR},
        </if>
        <if test="firstNameKana != null" >
            #{firstNameKana,jdbcType=VARCHAR},
        </if>
        <if test="secondNameKana != null" >
            #{secondNameKana,jdbcType=VARCHAR},
        </if>
        <if test="gender != null" >
            #{gender,jdbcType=TINYINT},
        </if>
        <if test="birthday != null" >
            #{birthday,jdbcType=DATE},
        </if>
        <if test="area != null" >
            #{area,jdbcType=TINYINT},
        </if>
        <if test="thumbnailUrl != null" >
            #{thumbnailUrl,jdbcType=VARCHAR},
        </if>
        <if test="career != null" >
            #{career,jdbcType=TINYINT},
        </if>
        <if test="zipcode != null" >
            #{zipcode,jdbcType=VARCHAR},
        </if>
        <if test="address != null" >
            #{address,jdbcType=VARCHAR},
        </if>
        <if test="address2 !=null">
            #{address2,jdbcType=VARCHAR},
        </if>
        <if test="address3 != null">
            #{address3,jdbcType=VARCHAR},
        </if>
        <if test="mail != null" >
            #{mail,jdbcType=VARCHAR},
        </if>
        <if test="createDatetime != null" >
            #{createDatetime,jdbcType=TIMESTAMP},
        </if>
        <if test="updateDatetime != null" >
            #{updateDatetime,jdbcType=TIMESTAMP},
        </if>
        <if test="delFlg != null" >
            #{delFlg,jdbcType=BIT},
        </if>
        <if test="note != null" >
            #{note,jdbcType=VARCHAR}
        </if> )
        <selectKey resultType="long" keyProperty="id" order="AFTER">
        select @@IDENTITY
        </selectKey>
</insert>

    <select id="getPersonById" resultMap="PersonResult">
        select
        <include refid="Base_Column_List" />
        from person
        where del_flg = 0
        AND  user_id = #{user_id}
    </select>

    <select id="getPersonByIdAndCondition" resultMap="PersonResult">
        select
        <include refid="Base_Column_List" />
        from person
        where del_flg = 0
        AND  user_id = #{id}
        <if test=" gender != 9">
            AND gender = #{gender}
        </if>
        <if test=" career != 0">
            AND career = #{career}
        </if>
    </select>

    <update id="" >
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Wed Feb 28 15:54:27 CST 2018.
        -->
        update person
        <set >
            <if test="nickname != null" >
                nickname = #{nickname,jdbcType=VARCHAR},
            </if>
            <if test="address != null" >
                address = #{address,jdbcType=VARCHAR},
            </if>
        </set>
        where user_id = #{userId}
    </update>

    <update id="updatePerson" parameterType="jp.co.vermore.entity.Person" >
    update person
    <set >

        <if test="nickname != null" >
            nickname = #{nickname,jdbcType=VARCHAR},
        </if>
        <if test="firstName != null" >
            first_name = #{firstName,jdbcType=VARCHAR},
        </if>
        <if test="secondName != null" >
            second_name = #{secondName,jdbcType=VARCHAR},
        </if>
        <if test="firstNameKana != null" >
            first_name_kana = #{firstNameKana,jdbcType=VARCHAR},
        </if>
        <if test="secondNameKana != null" >
            second_name_kana = #{secondNameKana,jdbcType=VARCHAR},
        </if>
        <if test="gender != null" >
            gender = #{gender,jdbcType=TINYINT},
        </if>
        <if test="birthday != null" >
            birthday = #{birthday,jdbcType=DATE},
        </if>
        <if test="area != null" >
            area = #{area,jdbcType=TINYINT},
        </if>
        <if test="thumbnailUrl != null and thumbnailUrl !='' " >
            thumbnail_url = #{thumbnailUrl,jdbcType=VARCHAR},
        </if>
        <if test="career != null" >
            career = #{career,jdbcType=TINYINT},
        </if>
        <if test="zipcode != null" >
            zipcode = #{zipcode,jdbcType=VARCHAR},
        </if>
        <if test="address != null" >
            address = #{address,jdbcType=VARCHAR},
        </if>
        <if test="address2 != null" >
            address2 = #{address2,jdbcType=VARCHAR},
        </if>
        <if test="address3 != null" >
            address3 = #{address3,jdbcType=VARCHAR},
        </if>
        <if test="mail != null" >
            mail = #{mail,jdbcType=VARCHAR},
        </if>
        <if test="createDatetime != null" >
            create_datetime = #{createDatetime,jdbcType=TIMESTAMP},
        </if>
        <if test="updateDatetime != null" >
            update_datetime = #{updateDatetime,jdbcType=TIMESTAMP},
        </if>
        <if test="delFlg != null" >
            del_flg = #{delFlg,jdbcType=BIT},
        </if>
        <if test="note != null" >
            note = #{note,jdbcType=VARCHAR},
        </if>
    </set>
    <if test="userId != null" >
        where user_id = #{userId}
    </if>
</update>

<delete id="deletePerson">
    update person set del_flg = 1 where user_id = #{userId}
</delete>


<select id="getPersonMailByUid" resultType="String">
    select mail from person where user_id = #{userId}
</select>


    <select id="getPersonByMail" resultMap="PersonResult">
        select
        <include refid="Base_Column_List" />
        from person
        where del_flg = 0
        AND  mail = #{mail}
        ORDER BY id DESC
        LIMIT 1
    </select>

    <select id="getPersonAll" resultMap="PersonResult">
        SELECT *
        FROM person
        WHERE del_flg = 0
    </select>

    <select id="getPersonByMailNull" resultMap="PersonResult">
        SELECT *
        FROM person
        WHERE mail = '';
    </select>

</mapper>



        <!--<insert id="" >-->
        <!--insert into person(-->
        <!--user_id,-->
        <!--nickname,-->
        <!--first_name,-->
        <!--second_name,-->
        <!--first_name_kana,-->
        <!--second_name_kana,-->
        <!--gender,-->
        <!--birthday,-->
        <!--area,-->
        <!--thumbnail_url,-->
        <!--career,-->
        <!--zipcode,-->
        <!--address,-->
        <!--create_datetime,-->
        <!--update_datetime,-->
        <!--del_flg,-->
        <!--note-->
        <!--) values (-->
        <!--#{userId},-->
        <!--#{nickname},-->
        <!--#{firstName},-->
        <!--#{secondName},-->
        <!--#{firstNameKana},-->
        <!--#{secondNameKana},-->
        <!--#{gender},-->
        <!--#{birthday},-->
        <!--#{area},-->
        <!--#{thumbnailUrl},-->
        <!--#{career},-->
        <!--#{zipcode},-->
        <!--#{address},-->
        <!--#{createDatetime},-->
        <!--#{updateDatetime},-->
        <!--#{delFlg},-->
        <!--#{note}-->
        <!--)-->
        <!--<selectKey resultType="long" keyProperty="id" order="AFTER">-->
        <!--select @@IDENTITY-->
        <!--</selectKey>-->
        <!--</insert>-->